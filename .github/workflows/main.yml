name: Website Update & Deploy (No API)

on:
  push:
    branches: [ main, master ]
  workflow_dispatch: # 加入這個按鈕，讓你可以手動點擊執行

permissions:
  contents: write # 確保有寫入權限建立 gh-pages

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      # 基礎環境檢查
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install Bandit
        run: pip install bandit

      - name: Basic Security Check
        run: bandit -r . -x ./test_lab || true 

      # 【關鍵部署步驟】請確保這一段存在且對齊正確
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: . # 將根目錄所有檔案（包含 index.html）發布
          branch: gh-pages # 指定發布到 gh-pages 分支